<!-- pages/detail/index.wxml -->
<view id="body">
  <!-- å…¨å±€æé†’ -->
  <i-message id="message" />
  <!-- åŠ è½½ä¸­ -->
  <i-spin fix wx:if="{{loading}}"></i-spin>
  <view style='background:#eee'>
    <view style='background:#fff'>
      <view class='feed-item'>
        <view class='title'>{{detail.title}}</view>
        <view class='listPic'>
          <image mode='widthFix' src="{{detail.listPic}}"></image>
        </view>
        <view class='tag-body'>
          <view class="postDate">
            <i-icon type="addressbook" color='#738a94' size='16' />
            <text class='author'>{{detail.author}}</text>
          </view>
          <view class="postDate">
            <i-icon type="browse" color='#738a94' size='18' />
            <text class='author'>{{detail.read_counts}}</text>
          </view>
          <view class="postDate">
            <i-icon type="time" color='#738a94' size='16' />
            <text class='author'>{{detail.createdAt}}</text>
          </view>
        </view>
      </view>
      <view class="wxParse-blockquote">
        <view class="wxParse-p">
          <view class="WxEmojiView wxParse-inline">{{detail.excerpt}}</view>
        </view>
      </view>
      <!-- å†…å®¹ -->
      <view class='content'>
        <view>
          <!-- highlightStyle preä»£ç é«˜äº®æ ·å¼ï¼Œå¯ç”¨å€¼default,darcula,dracula,tomorrow -->
          <htmltowxml text="{{detail.mdcontent}}" type="markdown" highlightStyle="darcula" linenums="{{true}}" showLoading="{{false}}" bindWxmlTagATap="wxmlTagATap" />
        </view>
      </view>
    </view>
    <!-- è¯„è®ºåŒº -->
    <view>
      <view wx:if="{{comment_count == 0}}" class="resp-head">æš‚æ— è¯„è®º</view>
      <view wx:else style='padding-bottom:60px;'>
        <view class="resp-head1">å…¨éƒ¨è¯„è®ºï¼ˆ{{ comment_count }}ï¼‰</view>
        <view class="comment" wx:for="{{comments}}" wx:key="comment">
          <!-- è¯„è®º -->
          <view class="comment-info">
            <view class="comment-author">
              <view bindlongpress="replyComment" data-id="{{item.id}}" data-parentcommentid="{{item.id}}" data-nickname="{{item.user_name}}" data-formid="2">
                <image class="comment-author-icon" src="{{item.avatarurl}}"></image>
              </view>
              <view class="comment-author-info">
                <view>{{ item.user_name }}</view>
                <view style="margin-top: 5px;">{{ item.create_time }}</view>
              </view>
            </view>
            <view class="comment-author-position">
              <view>{{ index + 1 }}æ¥¼</view>
            </view>
          </view>
          <view>
            <view class="h2w h2w-light">
              <view class="h2w__main">
                <view class="h2w__p">{{ item.content }}</view>
              </view>
            </view>
          </view>
          <!-- å›å¤ -->
          <view style=" background-color: #F5F5F5" hover-class="none" hover-stop-propagation="false">
            <view class="replys_box" wx:for="{{replys}}" wx:for-item="replys" wx:for-index="replys_index" wx:key="replys_index" wx:if="{{replys.parent_comment_id===item.id}}">
              <view class="comment-info">
                <view class="comment-author">
                  <view bindlongpress="replyComment" data-id="{{replys.id}}" data-parentcommentid="{{item.id}}" data-nickname="{{replys.user_name}}" data-formid="3">
                    <image class="comment-author-icon" src="{{replys.avatarurl}}"></image>
                  </view>
                  <view class="comment-author-info">
                    <view>{{ replys.user_name }}</view>
                    <view style="margin-top: 5px;">{{ replys.create_time }}</view>
                  </view>
                </view>
                <view class="comment-author-position"></view>
              </view>
              <view class="h2w h2w-light">
                <view class="h2w__main">
                  <view class="h2w__p">
                    <view wx:if="{{replys.reply_comment_name}}" style=" color:blue;display: inline-block;">
                      <text style="color: #333;">å›å¤</text>
                      @{{replys.reply_comment_name}}
                      <text style="color: #333;">:</text>
                    </view>
                    {{ replys.content }}
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
    <!-- åº•éƒ¨æ¡† -->
    <view class='comment-fixed'>
      <form bindsubmit="formSubmit" report-submit='true'>
        <view class="comment-respond">
          <view class="comment-box">
            <view wx:if="{{userInfo.nickName}}" style='display:flex;width:100%;'>
              <input bindinput="hendelGetValue" class="comment-input" confirmType="send" cursorSpacing="10" focus="{{focus}}" maxlength="100" name="inputComment" placeholder="è¯´ç‚¹ä»€ä¹ˆå§..." type="text" value="{{commentContent}}" />
              <!-- <view class="close_user">{{commentContent}}</view> -->
              <button class="comment-button {{touch_active?'touch-active':''}} " form-type="submit">
                å‘é€
              </button>
            </view>
            <view wx:else class="need-login" bindtap='goMy'>ç‚¹å‡»æ­¤å¤„æˆæƒï¼Œå³å¯è¯„è®ºæ–‡ç« ğŸ˜†</view>
            <view catchtap="showHideMenu" class="zan-icon zan-icon-add-o zan-font-20 icon-add">
              <image src='../../images/open.png' class='open'></image>
            </view>
          </view>
          <view class="menu-box {{isShow?'emoji-move-in':'emoji-move-out'}} {{isLoad?'no-emoji-move':''}}">
            <view class="iconList">
              <view class="iconLine">
                <view class="icon-type">
                  <view>
                    <image class="img-menu" src="../../images/share.png"></image>
                  </view>
                  <view>
                    <text>è½¬å‘</text>
                  </view>
                  <button class="share-button share-button touch-active" openType="share"></button>
                </view>
                <view catchtap="createPic" class="icon-type" wx:if="{{status}}">
                  <view>
                    <image class="img-menu" src="../../images/poster.png"></image>
                  </view>
                  <view>
                    <text>æµ·æŠ¥</text>
                  </view>
                </view>
                <view catchtap="collection" data-action="{{isCollect?'noCollect':'collect'}}" class="icon-type">
                  <view>
                    <image class="img-menu" src="../../images/{{isCollect?'collected.png':'collect.png'}}"></image>
                  </view>
                  <view>
                    <text wx:if="{{isCollect}}">å·²æ”¶è—</text>
                    <text wx:else>æ”¶è—</text>
                  </view>
                </view>
                <view catchtap="like" data-action="{{isLike?'noLike':'like'}}" class="icon-type">
                  <view>
                    <image class="img-menu" src="../../images/{{isLike?'liked.png':'like.png'}}"></image>
                  </view>
                  <view>
                    <text wx:if="{{isLike}}">å·²ç‚¹èµ</text>
                    <text wx:else>ç‚¹èµ</text>
                  </view>
                </view>
              </view>
            </view>
          </view>
        </view>
      </form>
    </view>
  </view>
</view>